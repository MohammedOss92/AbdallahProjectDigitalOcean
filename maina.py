import os
import django

# 1. ????? ???? Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'Abdallah_Project.settings')  # ?? ??? ?????? ???
django.setup()

# ??????? ??????? ???????? ?? Django
from Msgs_Api.models import Messages, MeesageType  # ?????? ???? ?????? ?????? MessageType

# 2. ????? ???? ?????? ???? ????? ??? ???????
folder_path = r"/root/Abdallah_Project3"  # ?????? ?????? ?????? ???? ????? ??? ???????

# 3. ????? ?????? ?? ???? ???????
content = ""
for i in range(1, 338):  # ?? 1 ??? 244
    file_path = os.path.join(folder_path, f"a ({i}).txt")  # ????? ??? ????? ???? ????????
    if os.path.exists(file_path):  # ?????? ?? ???? ?????
        with open(file_path, "r", encoding="utf8") as file:
            content += file.read() + "\n"  # ??? ????????? ?? ????? ???? ??? ???????

# 4. ????? ?????? ????? ??? ?????? ----
rows = [row.strip() for row in content.split("----") if row.strip()]

# 5. ?????? ??? ??? ??????? (MessageType) ?? ????? ????????
id_type_instance = MeesageType.objects.get(id=8)  # ?????? ??? ????? ????? ???? ???? ????

# 6. ????? ?????? ?? ????? ????????
for row in rows:
    Messages.objects.create(
        MessageName=row,
        ID_Type=id_type_instance,  # ??? ???? ?????? ???????
        new_msgs="1",
        new_msgs_text="1",
        day_num="0",
    )

print("?? ????? ?????? ????? ??? ????? ????????!")
print(Messages.objects.count())  # ????? ??? ??????? ???????
